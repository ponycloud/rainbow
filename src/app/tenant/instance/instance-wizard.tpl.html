<wizard on-finish="finishedWizard()" template="tenant/instance/wizard.tpl.html">
  <wz-step title="Name, CPU & RAM">
    <h1>Basic parameters</h1>

    <div class="col-md-5 well">
      <div class="form-group col-md-11">
        <label for="name">Name</label>
        <input type="text" id="name" class="form-control" ng-model="instance.name">
      </div>

      <div class="form-group col-md-5">
        <label for="vcpu">Virtual CPUs</label>
        <input type="number" min="1" id="vcpu" class="form-control" ng-model="instance.vcpu" placeholder="eg. 2">
      </div>

      <div class="form-group col-md-5">
        <label for="rcpu">Reserved CPUs</label>
        <input type="number" pattern="[0-9]+([\.|,][0-9]+)?" step="0.1" min="0" id="rcpu" class="form-control" ng-model="instance.rcpu" placeholder="eg. 0.1">
      </div>

      <div class="form-group col-md-5">
        <label for="cpu-profile">CPU profile</label>
        <select class="form-control" ng-model="instance.cpu_profile"
          ng-options="cpu_profile.desired.uuid as cpu_profile.desired.name + ' ('+ cpu_profile.desired.model +')' for cpu_profile in cpu_profiles">
        </select>
      </div>

      <div class="form-group col-md-5">
        <label for="boot-device">Boot device</label>
        <select class="form-control" ng-model="instance.boot">
          <option value="disk">
            Disk
          </option>
          <option value="network">
            Network
          </option>
        </select>
      </div>

      <div class="form-group col-md-12">
        <label for="rcpu">RAM size</label>
        <div class="btn-group">
          <label class="btn btn-default" ng-class="{active: instance.ram=='1024'}">
            <input type="radio" ng-model="instance.ram" class="hidden" value="1024">1GB
          </label>
          <label class="btn btn-default" ng-class="{active: instance.ram=='2048'}">
            <input type="radio" ng-model="instance.ram" class="hidden" value="2048">2GB
          </label>
          <label class="btn btn-default" ng-class="{active: instance.ram=='4096'}">
            <input type="radio" ng-model="instance.ram" class="hidden" value="4096">4GB
          </label>
          <label class="btn btn-default" ng-class="{active: instance.ram=='8192'}">
            <input type="radio" ng-model="instance.ram" class="hidden" value="8192">8GB
          </label>
          <label class="btn btn-default" ng-class="{active: instance.ram=='16384'}">
            <input type="radio" ng-model="instance.ram" class="hidden" value="16384">16GB
          </label>
          <div class="form-group col-md-4">
            <div class="input-group">
                <input type="text" class="form-control" ng-model="instance.ram" placeholder="Other">
                <div class="input-group-addon">MB</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-offset-1 col-md-5">
      <div class="bs-callout bs-callout-info">
        <h4>Virtual CPU</h4>
        <p>A virtual CPU equates to 1 physical core, but when your VM attempts to process something,
         it can potentially run on any of the cores that happen to be available at that moment.
         The scheduler handles this, and the VM is not aware of it. 
         You can assign multiple vCPUs to a VM which allows it to run concurrently across several cores.<p>

        <h4>Reserved CPU</h4>
        <p>What actually is reserved CPU is a mystery yet to solve!</p>

        <h4>CPU profile</h4>
        <p>Desired CPU family and model (eg. Nehalem)</p>
      </div>
    </div>
  </div>

  <div class="form-group col-md-11">
    <input type="submit" wz-next class="pull-right btn btn-lg btn-primary" value="Continue" />
  </div>

  </wz-step>

  <wz-step title="Storage">
      <h1>Storage</h1>
      <div class="bs-callout bs-callout-info">
        <h4>Volumes</h4>
        <p>Lorem ipsum</p>
        <h4>vDisks</h4>
        <p>What the hell this is?! Actually a vDisk is the representantion of a volume in this instance.</p>
        <h4>What should I do with all this?!</h4>
        <p>Here you should tell volumes to be virtual disks for this instance. If you wish to create a new volume, simply create one in another tab.</p>
      </div>
 
    <div pc-multiactions class="col-md-5 well">
     <h2>Volumes</h2>
      <ul class="nav nav-pills">
        <li class="pull-right">
            <input class="form-control" ng-model="search" placeholder="Filter">
        </li>
      </ul>

      <table class="table table-striped table-responsive table-hover" pc-table="{{search}}">
        <thead>
          <tr>
            <th pc-column="desired.name">Name</th>
            <th pc-column="desired.state">State</th>
            <th pc-column="desired.size">Size</th>
          </tr>
        </thead>
        <tr ng-repeat="volume in getFiltered(filteredVolumes)">
          <td>{{volume.desired.name}}</td>
          <td>{{volume.desired.state}}</td>
          <td>{{volume.desired.size|megabytes}}</td>
          <td><button class="btn btn-info" ng-show="!volume.selected" ng-click="assignVolume(volume)">Create vDisk</button>
          <button class="btn btn-danger" ng-show="volume.selected" ng-click="unassignVolume(volume)">Unassign</button></td>
        </tr>

      </table>
    </div>
    <div class="col-md-6 col-md-offset-1 well">
      <h2>vDisks</h2>
    <ul class="nav nav-pills">
      <li class="pull-right">
          <input class="form-control" ng-model="searchvdisks" placeholder="Filter">
      </li>
    </ul>

    <table class="table table-striped table-responsive table-hover" pc-table="{{searchvdisks}}">
      <thead>
        <tr>
          <th pc-column="volume.desired.name">Name</th>
          <th pc-column="volume.desired.state">State</th>
          <th pc-column="volume.desired.size">Size</th>
        </tr>
      </thead>
      <tbody ui-sortable ng-model="instance.vdisks">
        <tr ng-repeat="vdisk in getFiltered(instance.vdisks)">
          <td>{{vdisk.volume.desired.name}}</td>
          <td>{{vdisk.volume.desired.state}}</td>
          <td>{{vdisk.volume.desired.size|megabytes}}</td>
          <td>
            <button class="btn btn-danger" ng-show="vdisk.volume.selected" ng-click="unassignVolume(vdisk.volume)">Remove</button>
          </td>
        </tr>
      </tbody>
      </table>
    </div>

  <div class="form-group col-md-11">
    <input type="submit" wz-next class="btn btn-lg btn-primary pull-right" value="Continue" />
  </div>

  </wz-step>

  <wz-step title="Network">
    <h1>Network</h1>
    <div class="nav nav-pills">
      <button class="btn btn-primary" ng-click="addVnic()">
        Add vNIC
      </button>
    </div>
    <div ui-sortable ng-model="instance.vnics" class="col-md-8">
      <div ng-repeat="vnic in instance.vnics" class="col-md-12 well buffer">
        <div class="col-md-12">
        <h2>Link layer</h2>
          <div class="form-group col-sm-6">
              <label for="hwaddr">HW address</label>
              <input id="hwaddr" type="text" class="form-control" ng-model="vnic.desired.macaddr" placeholder="auto assign">
          </div>
          <div class="form-group col-sm-6">
            <label for="switch">Switch</label>
            <select id="switch" class="form-control" ng-model="vnic.switch" ng-options="switch.desired.uuid as switch.desired.name for switch in switches"></select>
          </div>

        </div>

        <div class="col-md-12">
          <h3>Internet layer</h3>
          <div class="alert alert-info" ng-if="!vnic.addresses.length">
            Add some IP addreses.
          </div>

          <div ng-repeat="address in vnic.addresses">

              <div class="form-group col-md-5">
                  <label for="network" class="col-sm-4">Network</label>
                  <div class="col-sm-8">
                    <select id="network" class="form-control"
                      ng-model="address.desired.network"
                      ng-options="network.desired.uuid as network.desired.range for network in vnic.networks">
                    </select>
                  </div>
              </div>

            <div class="form-group col-md-3">
              <input class="form-control" ng-model="address.desired.ip" placeholder="IP address (auto assign)">
            </div>
            <div class="form-group col-md-3">
              <input class="form-control" ng-model="address.desired.ptr" placeholder="Pointer record (PTR)">
            </div>
            <div class="form-group col-md-1">
              <button class="btn btn-sm btn-danger" ng-click="removeAddress(address, vnic)">
                <i class="glyphicon glyphicon-minus"></i>
              </button>
            </div>
          </div>
          <div class="form-group col-md-offset-11 col-md-1">
            <button class="btn btn-sm btn-success" ng-click="addAddress(vnic.networks[0].desired.uuid, vnic)">
              <i class="glyphicon glyphicon-plus"></i>
            </button>
          </div>
        </div>

        <div class="col-md-12">
          <button class="btn btn-danger" ng-click="removeVnic(vnic)">
            Remove vNIC 
          </button>
        </div>
      </div>
    </div>

    <div class="bs-callout bs-callout-info col-md-offset-1 col-md-3">
      <h4>Affinity groups</h4>
      <p>You can optionaly assing an instance to any number of affinity groups.
      <ul>
        <li><strong>Affinity</strong> means instances of the same group must be placed on the same physical host.</li>
        <li><strong>Anti-affinity</strong> means instances of the same group <strong>must NOT</strong> be placed on the same physical host.</li>
      </ul>
      </p>
    </div>

    <div class="form-group col-md-11">
      <input type="submit" wz-next class="btn btn-lg btn-primary pull-right" value="Continue" />
    </div>
  </wz-step>

  <wz-step title="Affinity">

    <div class="bs-callout bs-callout-info col-md-offset-1 col-md-6">
      <h4>Affinity groups</h4>
      <p>You can optionaly assing an instance to any number of affinity groups.
      <ul>
        <li><strong>Affinity</strong> means instances of the same group must be placed on the same physical host.</li>
        <li><strong>Anti-affinity</strong> means instances of the same group <strong>must NOT</strong> be placed on the same physical host.</li>
      </ul>
      </p>
    </div>

    <div pc-multiactions class="col-md-11 well">
     <h2>Affinity groups</h2>
      <ul class="nav nav-pills">
        <li class="pull-right">
            <input class="form-control" ng-model="search" placeholder="Filter">
        </li>
        <li class="pull-right">
            <pc-multieditbutton ></pc-multieditbutton>
        </li>
      </ul>

      <table class="table table-striped table-responsive table-hover" pc-table="{{search}}">
        <thead>
          <tr>
            <th pc-multiall />
            <th pc-column="desired.name">Name</th>
            <th pc-column="desired.type">Type</th>
          </tr>
        </thead>
        <tr ng-repeat="affinity_group in getFiltered(affinity_groups)">
          <td pc-multicheck="{{ affinity_group.desired.uuid }}"/>
          <td>{{affinity_group.desired.name}}</td>
          <td>{{affinity_group.desired.type}}</td>
        </tr>

        <tr>
          <td colspan="4" ng-show="editMode">
            <button class="btn btn-success" ng-click="assignSelectedAffinityGroups(getSelected())">
              Assign selected ({{selected.length}})
            </button>
          </td>
        </tr>

      </table>
    </div>

  </wz-step>

</wizard>

